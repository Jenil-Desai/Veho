const { GoogleGenerativeAI } = require("@google/generative-ai");

const genAI = new GoogleGenerativeAI(process.env.EXPO_PUBLIC_GOOGLE_GEMINI_AI_API_KEY);
const model = genAI.getGenerativeModel({ model: "gemini-2.0-flash-exp" });
const generationConfig = {
  temperature: 1,
  topP: 0.95,
  topK: 40,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};

export const chatSession = model.startChat({
  generationConfig,
  history: [
    {
      role: "user",
      parts: [
        {
          text: '{\n  "description": "Generate a detailed travel plan for a given location based on user input. Ensure the following guidelines are strictly followed:",\n  \n  "instructions": {\n    "location": “{Poicha}, {Vadodara}, {Gujarat}, {India}”,\n    "duration": “{2} Days and {1} Night",\n    "group_size": "{2-6 people}",\n    "budget": "{Balanced Journey}",\n    "elements": [\n      "Flight details",\n      "Flight Price with Booking URL",\n      "Hotel options list (with name, address, price, image URL, geo coordinates, rating, description)",\n      "Places to visit nearby (place name, details, image URL, geo coordinates, ticket pricing, travel time)",\n      "Day-wise itinerary (for each day, detailed plan with best time to visit)"\n    ]\n  },\n\n  "output_format": {\n    "trip_name": "{Location Name} Exploration",\n    "destination": "{Location Name}, {Region}, {State}, {Country}",\n    "duration": "{X} Days, {Y} Nights",\n    "group_size": "{2-6 People}",\n    "budget": "{Balanced Journey}",\n    "best_time_to_visit": "{Best Season (for example: October to March)}",\n    "flights": [\n      {\n        "note": "Flight details are approximate and may vary. Please check with actual booking websites for updated information.",\n        "origin": "{Your Origin City}",\n        "destination": "{Arrival Airport}",\n        "approx_price": "{Approx. Price (in INR)}",\n        "booking_url": "{URL for Booking (e.g., MakeMyTrip, Cleartrip, etc.)}"\n      }\n    ],\n    "transportation": {\n      "from_airport": "{Mode of transport from arrival airport to destination (e.g., Taxi, Pre-booked cab, etc.)}",\n      "local": "{Local transport options (e.g., Taxi, Auto-rickshaw)}"\n    },\n    "hotels": [\n      {\n        "hotel_name": "{Hotel Name}",\n        "address": "{Hotel Address}",\n        "price": "{Price per night (in INR)}",\n        "note": "Prices are approximate and may vary depending on the season and availability.",\n        "image_url": "{Hotel Image URL}",\n        "geo_coordinates": {\n          "latitude": "{Latitude}",\n          "longitude": "{Longitude}"\n        },\n        "rating": "{Rating (e.g., 4.5)}",\n        "description": "{Short Description of the hotel}"\n      }\n    ],\n    "day_plan": [\n      {\n        "day": 1,\n        "activities": [\n          {\n            "time": "{Start Time} - {End Time}",\n            "place_name": "{Place Name}",\n            "details": "{Description of the place}",\n            "image_url": "{Place Image URL}",\n            "geo_coordinates": {\n              "latitude": "{Latitude}",\n              "longitude": "{Longitude}"\n            },\n            "ticket_pricing": {\n              "approx_adult": "{Ticket Price for Adults (in INR)}",\n              "approx_child": "{Ticket Price for Children (in INR)}"\n            },\n            "travel_time": "{Travel time from last location (in hours/minutes)}",\n            "note": "Ticket prices may vary. Please check the official website for updated information."\n          },\n          {\n            "time": "{Start Time} - {End Time}",\n            "place_name": "{Place Name}",\n            "details": "{Description of the place}",\n            "image_url": "{Place Image URL}",\n            "geo_coordinates": {\n              "latitude": "{Latitude}",\n              "longitude": "{Longitude}"\n            },\n            "ticket_pricing": "{}",\n            "travel_time": "{Travel time (in minutes)}",\n            "note": "Ticket prices may vary. Please check on-site for updated information."\n          }\n        ]\n      },\n      {\n        "day": 2,\n        "activities": [\n          {\n            "time": "{Start Time} - {End Time}",\n            "place_name": "{Place Name}",\n            "details": "{Description of the place}",\n            "image_url": "{Place Image URL}",\n            "geo_coordinates": {\n              "latitude": "{Latitude}",\n              "longitude": "{Longitude}"\n            },\n            "ticket_pricing": {\n              "approx_adult": "{Ticket Price for Adults (in INR)}"\n            },\n            "travel_time": "{Travel time from last location (in hours/minutes)}",\n            "note": "Ticket prices may vary. Please check the official website for updated information."\n          },\n          {\n            "time": "{Start Time} - {End Time}",\n            "place_name": "Departure from {Departure Airport}",\n            "details": "Return journey to your origin city."\n          }\n        ]\n      }\n    ]\n  },\n\n  "validation": {\n    "urls": {\n      "image_urls": "Ensure all URLs for images are valid and working.",\n      "booking_urls": "Ensure the booking URLs are correct and lead to the exact mentioned booking platform.",\n      "place_urls": "Ensure all URLs for places (e.g., official websites or tourism links) are valid and working."\n    },\n    "price": "Ensure all prices are real, based on current data, and give accurate details. Avoid using approximations unless required.",\n    "geocoordinates": "Provide exact geo-coordinates (latitude, longitude) for all locations.",\n    "dynamic_replacement": "Ensure placeholders like {2-6 people}, {Your Origin City}, {Hotel Name}, etc., are correctly replaced based on the user’s input."\n  }\n}\n',
        },
      ],
    },
    {
      role: "model",
      parts: [
        {
          text: '```json\n{\n  "trip_name": "Poicha Exploration",\n  "destination": "Poicha, Vadodara, Gujarat, India",\n  "duration": "2 Days, 1 Night",\n  "group_size": "2-6 People",\n  "budget": "Balanced Journey",\n  "best_time_to_visit": "October to March",\n  "flights": [\n    {\n      "note": "Flight details are approximate and may vary. Please check with actual booking websites for updated information.",\n      "origin": "{Your Origin City}", \n      "destination": "Vadodara Airport (BDQ)",\n      "approx_price": "4000 INR",\n      "booking_url": "https://www.makemytrip.com/" \n    }\n  ],\n  "transportation": {\n    "from_airport": "Pre-booked cab or Taxi",\n    "local": "Taxi, Auto-rickshaw"\n  },\n  "hotels": [\n    {\n      "hotel_name": "Welcomhotel by ITC Hotels, Alkapuri, Vadodara",\n      "address": "RC Dutt Rd, Alkapuri, Vadodara, Gujarat 390007",\n      "price": "6000 INR",\n      "note": "Prices are approximate and may vary depending on the season and availability.",\n      "image_url": "https://www.itchotels.in/content/dam/itchotels/welcomhotel/hotels/welcomhotel-vadodara/images/overview/welcomhotel-vadodara-exterior-overview.jpg",\n      "geo_coordinates": {\n        "latitude": "22.0039",\n        "longitude": "73.1811"\n      },\n      "rating": "4.5",\n      "description": "Luxury hotel with modern amenities and dining options."\n    },\n        {\n      "hotel_name": "Hotel Surya Palace",\n      "address": "Sayajigunj, Vadodara, Gujarat 390005",\n      "price": "3000 INR",\n      "note": "Prices are approximate and may vary depending on the season and availability.",\n      "image_url": "https://gos3.ibcdn.com/fhbfgp-srs-1653388525.jpg", \n      "geo_coordinates": {\n        "latitude": "22.3240",\n        "longitude": "73.1929"\n      },\n      "rating": "4.0",\n      "description": "A comfortable and well-located hotel with good facilities."\n    }\n  ],\n  "day_plan": [\n    {\n      "day": 1,\n      "activities": [\n        {\n          "time": "9:00 AM - 5:00 PM",\n          "place_name": "Poicha",\n          "details": "Explore the Nilkanth Dham Swaminarayan Temple, a beautiful and intricate temple complex.",\n          "image_url": "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/1a/e9/82/67/caption.jpg?w=1200&h=-1&s=1",\n          "geo_coordinates": {\n            "latitude": "22.1181",\n            "longitude": "73.4017"\n          },\n          "ticket_pricing": {\n             "approx_adult": "Free",\n             "approx_child": "Free"\n          },          \n          "travel_time": "1 hour from Vadodara Airport",\n           "note":"Ticket prices may vary. Please check on-site for updated information."\n        },\n        {\n          "time": "7:00 PM - 9:00 PM",\n          "place_name": "Dinner at a local restaurant",\n          "details": "Enjoy a delicious Gujarati thali at a restaurant in Vadodara.",\n          "image_url": "https://www.holidify.com/images/cmsuploads/compressed/Gujarati_Thali_20180907110958.jpg",\n          "geo_coordinates": {\n            "latitude": "22.3071",\n            "longitude": "73.1812"\n          },\n          "ticket_pricing": {},\n          "travel_time": "1 hour",\n          "note": "Restaurant prices may vary."\n        }\n      ]\n    },\n    {\n      "day": 2,\n      "activities": [\n        {\n          "time": "9:00 AM - 12:00 PM",\n          "place_name": "Laxmi Vilas Palace",\n          "details": "Visit the magnificent Laxmi Vilas Palace, one of the largest private residences in the world.",          \n          "image_url": "https://upload.wikimedia.org/wikipedia/commons/thumb/8/84/Laxmi_Vilas_Palace_Vadodara_India.jpg/800px-Laxmi_Vilas_Palace_Vadodara_India.jpg",\n          "geo_coordinates": {\n            "latitude": "22.3039",\n            "longitude": "73.1839"\n          },\n          "ticket_pricing": {\n            "approx_adult": "225 INR"\n          },\n          "travel_time": "30 minutes",\n          "note": "Ticket prices may vary. Please check the official website for updated information."          \n        },\n        {\n          "time": "2:00 PM - 4:00 PM",\n          "place_name": "Departure from Vadodara Airport (BDQ)",\n          "details": "Return journey to your origin city."\n        }\n      ]\n    }\n  ]\n}\n``` \n',
        },
      ],
    },
  ],
});
